# Запуск приложения локально

---

## Настройка проекта

1. Клонируйте репозиторий и перейдите в проект

```
   git clone https://github.com/your-org/your-project.git
```

```
   cd your-project
```

2. Создайте в каждом микросервисе в папке `src/env` файл `.env.development.local` или выполните скрипт, который это сделает за вас одним из способов:

- Для windows

```shell
  New-Item -Path apps/gateway/src/env/.env.development.local -ItemType File
```

- Для linux

```shell
  touch apps/gateway/src/env/.env.development.local
```

3. С помощью команды создайте и запустите контейнер с БД postgresql для микросервиса

- gateway

```shell
  docker-compose -f apps/gateway/docker-compose.yml up -d
```

---

## Запуск микросервисов

1. Запустите микросервис

- gateway

```shell
  yarn gateway:start:dev
```

2. В случае если упадут ошибки, связанные с переменными окружения, — добавьте необходимые переменные в файл `.env.development.local`

---

## В проекте используются разные .env файлы для разных окружений:

.env.production — для продакшн-сборки

.env.development — для локальной разработки

.env.development.local — изменения переменных при локальной разработки

### Работа с файлами `.env`

1. Переменные окружения в файле `.env.production` используются как шаблон со всеми возможными значениями. При добавлении
   новых переменных в первую очередь они должны быть добавлены с описанием именно в него (чаще не содержат значений)

2. В `.env.development` хранятся переменные, необходимые для локальной разработки: без них проект не запустится, но их
   допустимо держать в открытом доступе, так как они **не содержат секретов** (не содержат секретов для подключения к облачной
   БД или другим внешним сервисам)

3. В `.env.development.local` **можно указывать секреты** или переопределять значения из других .env-файлов. Этот файл
   добавлен в .gitignore, поэтому в нём допустимо хранить информацию, которые нельзя размещать в `.env.development`.
   Переменные, заданные в этом файле, имеют приоритет над одноимёнными переменными из `.env.development` и `.env.production`

---

## Полезные команды для разработки

### Запуск микросервиса

- gateway

```shell
  yarn gateway:start:dev
```

### Создания миграции для микросервиса

- gateway

```shell
  yarn gateway:prisma:generate
```

### Запуск графического интерфейса Prisma Studio для работы с БД для микросервиса

- gateway

```shell
  yarn gateway:prisma:studio:dev
```

### Создать контейнер для микросервиса

При повторном запуске, если контейнер остановлен, то он снова запустится, а если уже запущен, то ничего не произойдет

- gateway

```shell
  docker-compose -f apps/gateway/docker-compose.yml up -d
```

### Полностью удалить контейнер и очистить volumes (удалит все данные из БД) для микросервиса

- gateway

```shell
  docker-compose -f apps/gateway/docker-compose.yml down -v
```
